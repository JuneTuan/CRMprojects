# JunLite CRM V5.2R1

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

JunLite CRM V5.2R1 æ˜¯ä¸€ä¸ªå®Œæ•´çš„å®¢æˆ·å…³ç³»ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæä¾›ç®¡ç†ç«¯å’ŒH5å‰ç«¯åŒç«¯æ”¯æŒã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¯ **å®Œæ•´çš„åŠŸèƒ½æ¨¡å—**ï¼šå®¢æˆ·ç®¡ç†ã€äº§å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€ä¼˜æƒ åˆ¸ç®¡ç†ã€æ´»åŠ¨ç®¡ç†ã€æŠ½å¥–ç³»ç»Ÿã€å‘˜å·¥ç®¡ç†ã€ç»Ÿè®¡åˆ†æ
- ğŸš€ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**ï¼šVue 3ã€NestJSã€TypeScriptã€MySQL
- ğŸ“± **åŒç«¯æ”¯æŒ**ï¼šWebç®¡ç†ç«¯ + H5å‰ç«¯
- ğŸ” **å®Œå–„çš„æƒé™ç³»ç»Ÿ**ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- ğŸ **è¥é”€æ´»åŠ¨**ï¼šä¼˜æƒ åˆ¸ã€æŠ½å¥–æ´»åŠ¨ã€ç§¯åˆ†ç³»ç»Ÿ
- ğŸ“Š **æ•°æ®ç»Ÿè®¡**ï¼šä»ªè¡¨æ¿ã€é”€å”®ç»Ÿè®¡ã€å®¢æˆ·åˆ†æ

---

## ğŸ“ ç›®å½•ç»“æ„

```
CRMprojects/
â”œâ”€â”€ admin-web/              # Webç®¡ç†ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/          # APIè¯·æ±‚é…ç½®
â”‚   â”‚   â”œâ”€â”€ assets/       # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ components/   # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/        # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Activity/     # æ´»åŠ¨ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Coupon/       # ä¼˜æƒ åˆ¸ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Customer/     # å®¢æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard/    # ä»ªè¡¨æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ Login/        # ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ Lottery/      # æŠ½å¥–ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Order/        # è®¢å•ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Permission/   # æƒé™ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Product/      # äº§å“ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Staff/        # å‘˜å·¥ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ Statistics/   # ç»Ÿè®¡åˆ†æ
â”‚   â”‚   â”œâ”€â”€ router/       # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ customerH5/             # H5å‰ç«¯ï¼ˆé¡¾å®¢ç§»åŠ¨ç«¯ï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/        # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ coupon-verify/    # ä¼˜æƒ åˆ¸æ ¸é”€
â”‚   â”‚   â”‚   â”œâ”€â”€ edit-profile/     # ç¼–è¾‘èµ„æ–™
â”‚   â”‚   â”‚   â”œâ”€â”€ game/            # æŠ½å¥–æ¸¸æˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ index/           # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ login/           # ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ lottery-record/   # æŠ½å¥–è®°å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ my-coupon/       # æˆ‘çš„ä¼˜æƒ åˆ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ points-history/   # ç§¯åˆ†è®°å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ profile/         # ä¸ªäººä¸­å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ purchase-record/  # è´­ä¹°è®°å½•
â”‚   â”‚   â”‚   â””â”€â”€ register/        # æ³¨å†Œé¡µ
â”‚   â”‚   â”œâ”€â”€ services/     # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ stores/       # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ types/        # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â”œâ”€â”€ main.ts
â”‚   â”‚   â”œâ”€â”€ manifest.json
â”‚   â”‚   â””â”€â”€ pages.json
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ server/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ activity/     # æ´»åŠ¨æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ activity.entity.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ activity.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ activity.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ activity.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ activity-game.entity.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ game-prize.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ game-type.entity.ts
â”‚   â”‚   â”œâ”€â”€ auth/         # è®¤è¯æˆæƒæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ strategies/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ role.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ role.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ user.service.ts
â”‚   â”‚   â”œâ”€â”€ coupon/       # ä¼˜æƒ åˆ¸æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ coupon.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ coupon.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ coupon.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ coupon.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ customer-coupon.entity.ts
â”‚   â”‚   â”œâ”€â”€ customer/     # å®¢æˆ·æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ customer.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ customer.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ customer.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ customer.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ points-record.entity.ts
â”‚   â”‚   â”œâ”€â”€ dashboard/    # ä»ªè¡¨æ¿æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ lottery/      # æŠ½å¥–æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ order/        # è®¢å•æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ prize/        # å¥–å“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ product/      # äº§å“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ staff/        # å‘˜å·¥æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ statistics/   # ç»Ÿè®¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â”œâ”€â”€ app.controller.ts
â”‚   â”‚   â”œâ”€â”€ app.service.ts
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ database-init-v3.sql    # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ nest-cli.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ archives/               # ç‰ˆæœ¬å½’æ¡£
â”œâ”€â”€ .git/                  # Gitç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ .gitignore             # Gitå¿½ç•¥è§„åˆ™
â””â”€â”€ .env.local             # æœ¬åœ°ç¯å¢ƒå˜é‡
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æœåŠ¡

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Node.js | 18+ | è¿è¡Œç¯å¢ƒ |
| NestJS | 10.0.0 | åç«¯æ¡†æ¶ |
| TypeScript | 5.x | ç±»å‹å®‰å…¨ |
| TypeORM | 0.3.0 | ORMæ¡†æ¶ |
| MySQL | 8.0+ | æ•°æ®åº“ |
| Passport | 0.6.0 | è®¤è¯ä¸­é—´ä»¶ |
| JWT | 10.0.0 | Tokenè®¤è¯ |
| bcrypt | 5.0.0 | å¯†ç åŠ å¯† |
| class-validator | 0.14.0 | æ•°æ®éªŒè¯ |

### Webç®¡ç†ç«¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue | 3.4.21 | å‰ç«¯æ¡†æ¶ |
| Vite | 5.4.21 | æ„å»ºå·¥å…· |
| TypeScript | 5.4.5 | ç±»å‹å®‰å…¨ |
| Element Plus | 2.13.2 | UIç»„ä»¶åº“ |
| Vue Router | 4.6.4 | è·¯ç”±ç®¡ç† |
| Pinia | 2.3.1 | çŠ¶æ€ç®¡ç† |
| Axios | 1.13.5 | HTTPå®¢æˆ·ç«¯ |
| Day.js | 1.11.19 | æ—¥æœŸå¤„ç† |

### H5å‰ç«¯ï¼ˆé¡¾å®¢ç§»åŠ¨ç«¯ï¼‰

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue | 3.4.21 | å‰ç«¯æ¡†æ¶ |
| UniApp | 3.0.0 | è·¨å¹³å°æ¡†æ¶ |
| TypeScript | 5.4.5 | ç±»å‹å®‰å…¨ |
| Pinia | 2.1.7 | çŠ¶æ€ç®¡ç† |
| Vite | 5.2.8 | æ„å»ºå·¥å…· |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JunLite CRM V5.2R1                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Web   â”‚    â”‚   Server    â”‚    â”‚  Mini App   â”‚
â”‚  (Vue 3)    â”‚    â”‚  (NestJS)  â”‚    â”‚  (UniApp)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚    MySQL DB    â”‚
                      â”‚   (17 Tables)  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   NestJS Application                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Controllers  â†’  Services  â†’  Entities  â†’  Database  â”‚
â”‚     â”‚              â”‚            â”‚             â”‚          â”‚
â”‚  Auth Module    Auth Module  User Entity   users     â”‚
â”‚  Customer Module Customer Module Customer Entity customers â”‚
â”‚  Product Module Product Module Product Entity products   â”‚
â”‚  Order Module   Order Module   Order Entity   orders     â”‚
â”‚  Coupon Module  Coupon Module  Coupon Entity  coupons    â”‚
â”‚  Activity Module Activity Module Activity Entity activities â”‚
â”‚  Prize Module   Prize Module   Prize Entity   prizes     â”‚
â”‚  Lottery Module Lottery Module Lottery Entity lottery    â”‚
â”‚  Staff Module   Staff Module   Staff Entity   staff      â”‚
â”‚  Statistics Module Statistics Module               stats      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®åº“è®¾è®¡

ç³»ç»ŸåŒ…å«17å¼ æ ¸å¿ƒæ•°æ®è¡¨ï¼š

| è¡¨å | ç”¨é€” | å…³é”®å­—æ®µ |
|------|------|----------|
| roles | è§’è‰²ç®¡ç† | id, name, description |
| permissions | æƒé™ç®¡ç† | id, name, code |
| users | ç”¨æˆ·ç®¡ç† | id, username, password, role_id |
| customers | å®¢æˆ·ç®¡ç† | id, name, phone, points |
| products | äº§å“ç®¡ç† | id, name, price, stock |
| coupons | ä¼˜æƒ åˆ¸ç®¡ç† | id, name, type, value |
| orders | è®¢å•ç®¡ç† | id, order_no, total_amount |
| order_items | è®¢å•æ˜ç»† | id, order_id, product_id |
| customer_coupons | å®¢æˆ·ä¼˜æƒ åˆ¸ | id, customer_id, coupon_id |
| game_types | æ¸¸æˆç±»å‹ | id, type, name |
| activities | æ´»åŠ¨ç®¡ç† | id, name, start_time |
| activity_games | æ´»åŠ¨æ¸¸æˆ | id, activity_id, game_type_id |
| prizes | å¥–å“ç®¡ç† | id, name, type, probability |
| game_prizes | æ¸¸æˆå¥–å“ | id, activity_game_id, prize_id |
| lottery_records | æŠ½å¥–è®°å½• | id, customer_id, prize_id |
| points_records | ç§¯åˆ†è®°å½• | id, customer_id, points |
| role_permissions | è§’è‰²æƒé™ | id, role_id, permission_id |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- MySQL 8.0+
- npm æˆ– pnpm

### 1. æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p < server/database-init-v3.sql
```

### 2. åç«¯æœåŠ¡å¯åŠ¨

```bash
cd server
npm install
cp .env.example .env
# é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯
npm run start:dev
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:3001` å¯åŠ¨

### 3. Webç®¡ç†ç«¯å¯åŠ¨

```bash
cd admin-web
npm install
npm run dev
```

ç®¡ç†ç«¯å°†åœ¨ `http://localhost:5173` å¯åŠ¨

### 4. H5å‰ç«¯å¯åŠ¨

```bash
cd customerH5
npm install
npm run dev:h5
```

H5ç‰ˆæœ¬å°†åœ¨æµè§ˆå™¨ä¸­å¯åŠ¨

---

## ğŸ“¦ åŠŸèƒ½æ¨¡å—

### ç®¡ç†ç«¯åŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ |
|------|------|
| ä»ªè¡¨æ¿ | æ•°æ®æ¦‚è§ˆã€ç»Ÿè®¡å›¾è¡¨ |
| å®¢æˆ·ç®¡ç† | å®¢æˆ·CRUDã€ç§¯åˆ†ç®¡ç†ã€ç§¯åˆ†å†å² |
| äº§å“ç®¡ç† | äº§å“CRUDã€åº“å­˜ç®¡ç† |
| è®¢å•ç®¡ç† | è®¢å•CRUDã€æ”¯ä»˜ã€å–æ¶ˆ |
| ä¼˜æƒ åˆ¸ç®¡ç† | ä¼˜æƒ åˆ¸CRUDã€æ ¸é”€ |
| æ´»åŠ¨ç®¡ç† | æ´»åŠ¨CRUDã€æ¸¸æˆé…ç½® |
| æŠ½å¥–ç®¡ç† | å¥–å“ç®¡ç†ã€æŠ½å¥–è®°å½• |
| å‘˜å·¥ç®¡ç† | å‘˜å·¥CRUDã€è§’è‰²æƒé™ |
| ç»Ÿè®¡åˆ†æ | é”€å”®ç»Ÿè®¡ã€å®¢æˆ·åˆ†æ |

### H5å‰ç«¯åŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ |
|------|------|
| ç™»å½•æ³¨å†Œ | ç”¨æˆ·è®¤è¯ |
| é¦–é¡µ | æ´»åŠ¨åˆ—è¡¨ã€æ¸¸æˆå…¥å£ |
| æŠ½å¥–æ¸¸æˆ | å‚ä¸æŠ½å¥–æ´»åŠ¨ |
| æˆ‘çš„ä¼˜æƒ åˆ¸ | ä¼˜æƒ åˆ¸åˆ—è¡¨ã€ä½¿ç”¨ |
| ç§¯åˆ†è®°å½• | ç§¯åˆ†ä½™é¢ã€ç§¯åˆ†å†å² |
| è´­ä¹°è®°å½• | è®¢å•åˆ—è¡¨ã€è®¢å•è¯¦æƒ… |
| æŠ½å¥–è®°å½• | æŠ½å¥–å†å²ã€å¥–å“é¢†å– |
| ä¸ªäººä¸­å¿ƒ | ç”¨æˆ·ä¿¡æ¯ã€è®¾ç½® |
| ä¼˜æƒ åˆ¸æ ¸é”€ | æ‰«ç æ ¸é”€ä¼˜æƒ åˆ¸ |

---

## ğŸ”Œ APIæ¥å£

### è®¤è¯æ¥å£

```
POST /auth/login        # ç”¨æˆ·ç™»å½•
POST /auth/register     # ç”¨æˆ·æ³¨å†Œ
GET  /auth/profile      # è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆéœ€è®¤è¯ï¼‰
```

### å®¢æˆ·æ¥å£

```
GET    /customers              # è·å–å®¢æˆ·åˆ—è¡¨
GET    /customers/:id          # è·å–å®¢æˆ·è¯¦æƒ…
POST   /customers              # åˆ›å»ºå®¢æˆ·ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /customers/:id          # æ›´æ–°å®¢æˆ·ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /customers/:id          # åˆ é™¤å®¢æˆ·ï¼ˆéœ€è®¤è¯ï¼‰
GET    /customers/:id/points-history # è·å–ç§¯åˆ†å†å²
POST   /customers/:id/add-points    # å¢åŠ ç§¯åˆ†
POST   /customers/:id/use-points    # ä½¿ç”¨ç§¯åˆ†
```

### äº§å“æ¥å£

```
GET    /products              # è·å–äº§å“åˆ—è¡¨
GET    /products/:id          # è·å–äº§å“è¯¦æƒ…
POST   /products              # åˆ›å»ºäº§å“ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /products/:id          # æ›´æ–°äº§å“ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /products/:id          # åˆ é™¤äº§å“ï¼ˆéœ€è®¤è¯ï¼‰
GET    /products/category/:category # æŒ‰åˆ†ç±»æŸ¥è¯¢
```

### è®¢å•æ¥å£

```
GET    /orders                # è·å–è®¢å•åˆ—è¡¨
GET    /orders/:id            # è·å–è®¢å•è¯¦æƒ…
GET    /orders/customer/:customerId # æŒ‰å®¢æˆ·æŸ¥è¯¢
POST   /orders                # åˆ›å»ºè®¢å•ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /orders/:id            # æ›´æ–°è®¢å•ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /orders/:id/pay        # æ”¯ä»˜è®¢å•
PUT    /orders/:id/cancel     # å–æ¶ˆè®¢å•
DELETE /orders/:id            # åˆ é™¤è®¢å•ï¼ˆéœ€è®¤è¯ï¼‰
```

### ä¼˜æƒ åˆ¸æ¥å£

```
GET    /coupons                       # è·å–ä¼˜æƒ åˆ¸åˆ—è¡¨
GET    /coupons/:id                   # è·å–ä¼˜æƒ åˆ¸è¯¦æƒ…
GET    /coupons/customer/:customerId  # æŒ‰å®¢æˆ·æŸ¥è¯¢
POST   /coupons                       # åˆ›å»ºä¼˜æƒ åˆ¸ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /coupons/:id                   # æ›´æ–°ä¼˜æƒ åˆ¸ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /coupons/:id                   # åˆ é™¤ä¼˜æƒ åˆ¸ï¼ˆéœ€è®¤è¯ï¼‰
POST   /coupons/customer/:customerId/claim/:couponId  # é¢†å–ä¼˜æƒ åˆ¸
POST   /coupons/customer/:customerId/use/:couponId     # ä½¿ç”¨ä¼˜æƒ åˆ¸
```

### æ´»åŠ¨æ¥å£

```
GET    /activities              # è·å–æ´»åŠ¨åˆ—è¡¨
GET    /activities/:id          # è·å–æ´»åŠ¨è¯¦æƒ…
POST   /activities              # åˆ›å»ºæ´»åŠ¨ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /activities/:id          # æ›´æ–°æ´»åŠ¨ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /activities/:id          # åˆ é™¤æ´»åŠ¨ï¼ˆéœ€è®¤è¯ï¼‰
GET    /activities/game-types/all # è·å–æ‰€æœ‰æ¸¸æˆç±»å‹
POST   /activities/game-types   # åˆ›å»ºæ¸¸æˆç±»å‹ï¼ˆéœ€è®¤è¯ï¼‰
POST   /activities/:id/games   # æ·»åŠ æ¸¸æˆåˆ°æ´»åŠ¨
POST   /activities/:activityId/games/:gameId/prizes # æ·»åŠ å¥–å“åˆ°æ¸¸æˆ
```

### å¥–å“æ¥å£

```
GET    /prizes         # è·å–å¥–å“åˆ—è¡¨
GET    /prizes/:id     # è·å–å¥–å“è¯¦æƒ…
POST   /prizes         # åˆ›å»ºå¥–å“ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /prizes/:id     # æ›´æ–°å¥–å“ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /prizes/:id     # åˆ é™¤å¥–å“ï¼ˆéœ€è®¤è¯ï¼‰
```

### æŠ½å¥–æ¥å£

```
GET    /lottery/records              # è·å–æŠ½å¥–è®°å½•
GET    /lottery/records/customer/:customerId # æŒ‰å®¢æˆ·æŸ¥è¯¢
POST   /lottery/draw                 # æŠ½å¥–ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /lottery/records/:id/claim    # é¢†å–å¥–å“ï¼ˆéœ€è®¤è¯ï¼‰
```

### å‘˜å·¥æ¥å£

```
GET    /staff              # è·å–å‘˜å·¥åˆ—è¡¨
GET    /staff/:id          # è·å–å‘˜å·¥è¯¦æƒ…
POST   /staff              # åˆ›å»ºå‘˜å·¥ï¼ˆéœ€è®¤è¯ï¼‰
PUT    /staff/:id          # æ›´æ–°å‘˜å·¥ï¼ˆéœ€è®¤è¯ï¼‰
DELETE /staff/:id          # åˆ é™¤å‘˜å·¥ï¼ˆéœ€è®¤è¯ï¼‰
GET    /staff/roles/all    # è·å–æ‰€æœ‰è§’è‰²
POST   /staff/roles        # åˆ›å»ºè§’è‰²ï¼ˆéœ€è®¤è¯ï¼‰
GET    /staff/permissions/all # è·å–æ‰€æœ‰æƒé™
POST   /staff/permissions     # åˆ›å»ºæƒé™ï¼ˆéœ€è®¤è¯ï¼‰
POST   /staff/roles/:roleId/permissions # æ·»åŠ æƒé™åˆ°è§’è‰²
```

---

## ğŸ” è®¤è¯ä¸æˆæƒ

ç³»ç»Ÿé‡‡ç”¨JWT Tokenè®¤è¯æœºåˆ¶ï¼š

1. **ç™»å½•æµç¨‹**
   - ç”¨æˆ·æäº¤ç”¨æˆ·åå’Œå¯†ç 
   - åç«¯éªŒè¯å¹¶ç”ŸæˆJWT Token
   - å‰ç«¯å­˜å‚¨Tokenåˆ°localStorage
   - åç»­è¯·æ±‚æºå¸¦Token

2. **æƒé™æ§åˆ¶**
   - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
   - è§’è‰²åŒ…å«å¤šä¸ªæƒé™
   - æ¥å£çº§åˆ«çš„æƒé™éªŒè¯

3. **é»˜è®¤è§’è‰²**
   - è¶…çº§ç®¡ç†å‘˜ï¼šæ‹¥æœ‰æ‰€æœ‰æƒé™
   - ç®¡ç†å‘˜ï¼šæ‹¥æœ‰å¤§éƒ¨åˆ†æƒé™
   - å‘˜å·¥ï¼šæ‹¥æœ‰åŸºæœ¬æ“ä½œæƒé™

---

## ğŸ“Š æ•°æ®åº“é…ç½®

### ç¯å¢ƒå˜é‡

åœ¨ `server/.env` ä¸­é…ç½®æ•°æ®åº“è¿æ¥ï¼š

```env
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=your_password
DB_DATABASE=crm_system
PORT=3001
```

### æ•°æ®åº“åˆå§‹åŒ–

```bash
# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
mysql -u root -p < server/database-init-v3.sql
```

---

## ğŸš¢ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### 1. åç«¯éƒ¨ç½²

```bash
cd server
npm run build
npm run start:prod
```

#### 2. ç®¡ç†ç«¯éƒ¨ç½²

```bash
cd admin-web
npm run build
# å°†distç›®å½•éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
```

#### 3. H5å‰ç«¯éƒ¨ç½²

```bash
cd customerH5
npm run build:h5
# å°†distç›®å½•éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
```

### Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒï¼š[DOCKER_DEPLOYMENT.md](./DOCKER_DEPLOYMENT.md)

### ä¼ ç»Ÿéƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

```bash
# åç«¯éƒ¨ç½²
cd server
npm run build
# ä½¿ç”¨PM2å¯åŠ¨

# ç®¡ç†åå°éƒ¨ç½²
cd admin-web
npm run build
# å°†distç›®å½•éƒ¨ç½²åˆ°WebæœåŠ¡å™¨

# H5å‰ç«¯éƒ¨ç½²
cd customerH5
npm run build:h5
# å°†distç›®å½•éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
```

---

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- ä½¿ç”¨TypeScriptè¿›è¡Œç±»å‹æ£€æŸ¥
- éµå¾ªESLintè§„åˆ™
- ä½¿ç”¨Prettieræ ¼å¼åŒ–ä»£ç 

### Gitæäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾ç›¸å…³
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: åç«¯å¯åŠ¨å¤±è´¥ï¼Ÿ

A: æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®ï¼Œç¡®ä¿MySQLæœåŠ¡å·²å¯åŠ¨ï¼Œæ•°æ®åº“å·²åˆ›å»ºã€‚

### Q2: å‰ç«¯æ— æ³•è¿æ¥åç«¯ï¼Ÿ

A: æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦åœ¨3001ç«¯å£è¿è¡Œï¼Œæ£€æŸ¥é˜²ç«å¢™è®¾ç½®ã€‚

### Q3: H5å‰ç«¯APIè°ƒç”¨å¤±è´¥ï¼Ÿ

A: æ£€æŸ¥API BaseURLé…ç½®ï¼Œç¡®ä¿æŒ‡å‘æ­£ç¡®çš„åç«¯åœ°å€ã€‚

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ã€‚

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤Issue
- å‘é€é‚®ä»¶

---

**ç‰ˆæœ¬**: V5.2R1  
**æœ€åæ›´æ–°**: 2026-02-26  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
